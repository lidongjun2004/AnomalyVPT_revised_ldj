2025-08-09 17:50:08.058 | INFO     | src.datasets.Dataset:read_split:290 - Reading split from /data/users/ldj/dataset/mvtec_ad/split.json
2025-08-09 17:50:08.078 | INFO     | src.datasets.Dataset:__init__:124 - Loading preprocessed few-shot data from /data/users/ldj/dataset/mvtec_ad/split_fewshot/shot_256-seed_1003.pkl
2025-08-09 17:50:08.081 | INFO     | src.helper:build_model:21 - Loading model ViT-B-16
2025-08-09 17:50:08.081 | INFO     | src.helper:build_model:24 - Building CustomCLIP
2025-08-09 17:50:08.081 | INFO     | src.helper:build_model:30 - Now load openai model
2025-08-09 17:50:08.919 | INFO     | src.open_clip.model_revise:_build_vision_tower:169 - CLIPPromptCfg(vision_prompt_length=[16], vision_prompt_layer_idx=[20], text_prompt_length=None, text_prompt_layer_idx=None, group_layer_idx=[10, 14, 18, 22], feature_layer=[7, 11, 15, 23], pseudo_layer=None, mid_loss=True)
2025-08-09 17:50:19.790 | SUCCESS  | src.helper:build_model:71 - clip_model.visual.learnable_prompt.p.0 requires grad.
2025-08-09 17:50:19.795 | SUCCESS  | src.helper:build_model:71 - seg_decoder.positional_embedding requires grad.
2025-08-09 17:50:19.795 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.0.layers.0.self_attn.in_proj_weight requires grad.
2025-08-09 17:50:19.795 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.0.layers.0.self_attn.in_proj_bias requires grad.
2025-08-09 17:50:19.795 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.0.layers.0.self_attn.out_proj.weight requires grad.
2025-08-09 17:50:19.795 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.0.layers.0.self_attn.out_proj.bias requires grad.
2025-08-09 17:50:19.795 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.0.layers.0.linear1.weight requires grad.
2025-08-09 17:50:19.796 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.0.layers.0.linear1.bias requires grad.
2025-08-09 17:50:19.796 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.0.layers.0.linear2.weight requires grad.
2025-08-09 17:50:19.796 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.0.layers.0.linear2.bias requires grad.
2025-08-09 17:50:19.796 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.0.layers.0.ln_pre.weight requires grad.
2025-08-09 17:50:19.796 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.0.layers.0.ln_pre.bias requires grad.
2025-08-09 17:50:19.796 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.0.layers.0.ln_post.weight requires grad.
2025-08-09 17:50:19.796 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.0.layers.0.ln_post.bias requires grad.
2025-08-09 17:50:19.796 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.0.layers.0.swiglu.w1.weight requires grad.
2025-08-09 17:50:19.796 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.0.layers.0.swiglu.w1.bias requires grad.
2025-08-09 17:50:19.796 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.0.layers.0.swiglu.w2.weight requires grad.
2025-08-09 17:50:19.796 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.0.layers.0.swiglu.w2.bias requires grad.
2025-08-09 17:50:19.796 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.0.layers.0.swiglu.w3.weight requires grad.
2025-08-09 17:50:19.796 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.0.layers.0.swiglu.w3.bias requires grad.
2025-08-09 17:50:19.797 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.0.norm.weight requires grad.
2025-08-09 17:50:19.797 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.0.norm.bias requires grad.
2025-08-09 17:50:19.797 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.1.layers.0.self_attn.in_proj_weight requires grad.
2025-08-09 17:50:19.797 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.1.layers.0.self_attn.in_proj_bias requires grad.
2025-08-09 17:50:19.797 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.1.layers.0.self_attn.out_proj.weight requires grad.
2025-08-09 17:50:19.797 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.1.layers.0.self_attn.out_proj.bias requires grad.
2025-08-09 17:50:19.797 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.1.layers.0.linear1.weight requires grad.
2025-08-09 17:50:19.797 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.1.layers.0.linear1.bias requires grad.
2025-08-09 17:50:19.797 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.1.layers.0.linear2.weight requires grad.
2025-08-09 17:50:19.797 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.1.layers.0.linear2.bias requires grad.
2025-08-09 17:50:19.797 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.1.layers.0.ln_pre.weight requires grad.
2025-08-09 17:50:19.797 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.1.layers.0.ln_pre.bias requires grad.
2025-08-09 17:50:19.797 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.1.layers.0.ln_post.weight requires grad.
2025-08-09 17:50:19.798 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.1.layers.0.ln_post.bias requires grad.
2025-08-09 17:50:19.798 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.1.layers.0.swiglu.w1.weight requires grad.
2025-08-09 17:50:19.798 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.1.layers.0.swiglu.w1.bias requires grad.
2025-08-09 17:50:19.798 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.1.layers.0.swiglu.w2.weight requires grad.
2025-08-09 17:50:19.798 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.1.layers.0.swiglu.w2.bias requires grad.
2025-08-09 17:50:19.798 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.1.layers.0.swiglu.w3.weight requires grad.
2025-08-09 17:50:19.798 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.1.layers.0.swiglu.w3.bias requires grad.
2025-08-09 17:50:19.798 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.1.norm.weight requires grad.
2025-08-09 17:50:19.798 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.1.norm.bias requires grad.
2025-08-09 17:50:19.798 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.2.layers.0.self_attn.in_proj_weight requires grad.
2025-08-09 17:50:19.798 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.2.layers.0.self_attn.in_proj_bias requires grad.
2025-08-09 17:50:19.798 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.2.layers.0.self_attn.out_proj.weight requires grad.
2025-08-09 17:50:19.798 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.2.layers.0.self_attn.out_proj.bias requires grad.
2025-08-09 17:50:19.798 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.2.layers.0.linear1.weight requires grad.
2025-08-09 17:50:19.799 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.2.layers.0.linear1.bias requires grad.
2025-08-09 17:50:19.799 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.2.layers.0.linear2.weight requires grad.
2025-08-09 17:50:19.799 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.2.layers.0.linear2.bias requires grad.
2025-08-09 17:50:19.799 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.2.layers.0.ln_pre.weight requires grad.
2025-08-09 17:50:19.799 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.2.layers.0.ln_pre.bias requires grad.
2025-08-09 17:50:19.799 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.2.layers.0.ln_post.weight requires grad.
2025-08-09 17:50:19.799 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.2.layers.0.ln_post.bias requires grad.
2025-08-09 17:50:19.799 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.2.layers.0.swiglu.w1.weight requires grad.
2025-08-09 17:50:19.799 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.2.layers.0.swiglu.w1.bias requires grad.
2025-08-09 17:50:19.799 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.2.layers.0.swiglu.w2.weight requires grad.
2025-08-09 17:50:19.799 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.2.layers.0.swiglu.w2.bias requires grad.
2025-08-09 17:50:19.799 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.2.layers.0.swiglu.w3.weight requires grad.
2025-08-09 17:50:19.799 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.2.layers.0.swiglu.w3.bias requires grad.
2025-08-09 17:50:19.799 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.2.norm.weight requires grad.
2025-08-09 17:50:19.800 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.2.norm.bias requires grad.
2025-08-09 17:50:19.800 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.3.layers.0.self_attn.in_proj_weight requires grad.
2025-08-09 17:50:19.800 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.3.layers.0.self_attn.in_proj_bias requires grad.
2025-08-09 17:50:19.800 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.3.layers.0.self_attn.out_proj.weight requires grad.
2025-08-09 17:50:19.800 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.3.layers.0.self_attn.out_proj.bias requires grad.
2025-08-09 17:50:19.800 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.3.layers.0.linear1.weight requires grad.
2025-08-09 17:50:19.800 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.3.layers.0.linear1.bias requires grad.
2025-08-09 17:50:19.800 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.3.layers.0.linear2.weight requires grad.
2025-08-09 17:50:19.800 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.3.layers.0.linear2.bias requires grad.
2025-08-09 17:50:19.800 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.3.layers.0.ln_pre.weight requires grad.
2025-08-09 17:50:19.800 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.3.layers.0.ln_pre.bias requires grad.
2025-08-09 17:50:19.800 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.3.layers.0.ln_post.weight requires grad.
2025-08-09 17:50:19.800 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.3.layers.0.ln_post.bias requires grad.
2025-08-09 17:50:19.800 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.3.layers.0.swiglu.w1.weight requires grad.
2025-08-09 17:50:19.800 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.3.layers.0.swiglu.w1.bias requires grad.
2025-08-09 17:50:19.801 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.3.layers.0.swiglu.w2.weight requires grad.
2025-08-09 17:50:19.801 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.3.layers.0.swiglu.w2.bias requires grad.
2025-08-09 17:50:19.801 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.3.layers.0.swiglu.w3.weight requires grad.
2025-08-09 17:50:19.801 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.3.layers.0.swiglu.w3.bias requires grad.
2025-08-09 17:50:19.801 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.3.norm.weight requires grad.
2025-08-09 17:50:19.801 | SUCCESS  | src.helper:build_model:71 - seg_decoder.transformer.3.norm.bias requires grad.
2025-08-09 17:50:19.801 | SUCCESS  | src.helper:build_model:71 - seg_decoder.proj.0 requires grad.
2025-08-09 17:50:19.801 | SUCCESS  | src.helper:build_model:71 - seg_decoder.proj.1 requires grad.
2025-08-09 17:50:19.801 | SUCCESS  | src.helper:build_model:71 - seg_decoder.proj.2 requires grad.
2025-08-09 17:50:19.801 | SUCCESS  | src.helper:build_model:71 - seg_decoder.proj.3 requires grad.
2025-08-09 17:50:23.999 | INFO     | src.train:forward:129 - epoch [1/80] batch [5/53] loss 5.0890 (8.0171) i-auroc 57.4879 (68.2947) p-auroc 44.1416 (52.9395) focal_loss 0.6479 (1.9771) a_dice_loss 0.9853 (0.9169) p-ce_loss 0.6560 (2.1760) lr 2.0000e-03
2025-08-09 17:50:24.357 | INFO     | src.train:forward:129 - epoch [1/80] batch [10/53] loss 5.8452 (6.5954) i-auroc 66.6667 (66.1622) p-auroc 42.8455 (49.3293) focal_loss 0.2050 (1.1615) a_dice_loss 0.9823 (0.9350) p-ce_loss 0.2082 (1.2651) lr 2.0000e-03
2025-08-09 17:50:25.089 | INFO     | src.train:forward:129 - epoch [1/80] batch [15/53] loss 3.9245 (5.8665) i-auroc 84.3750 (71.7204) p-auroc 54.6954 (50.5821) focal_loss 0.1563 (0.8402) a_dice_loss 0.9889 (0.9528) p-ce_loss 0.1668 (0.9106) lr 2.0000e-03
2025-08-09 17:50:26.558 | INFO     | src.train:forward:129 - epoch [1/80] batch [20/53] loss 3.5494 (5.3235) i-auroc 79.3651 (74.3420) p-auroc 50.0962 (53.3839) focal_loss 0.1373 (0.6497) a_dice_loss 0.9715 (0.9581) p-ce_loss 0.2054 (0.7230) lr 2.0000e-03
2025-08-09 17:50:26.896 | INFO     | src.train:forward:129 - epoch [1/80] batch [25/53] loss 3.2421 (4.8941) i-auroc 94.6429 (78.7676) p-auroc 30.8902 (52.8645) focal_loss 0.1390 (0.5358) a_dice_loss 0.9811 (0.9617) p-ce_loss 0.1839 (0.6096) lr 2.0000e-03
2025-08-09 17:50:27.628 | INFO     | src.train:forward:129 - epoch [1/80] batch [30/53] loss 4.9178 (4.9307) i-auroc 55.2083 (72.9413) p-auroc 38.6259 (50.7957) focal_loss 0.1889 (0.5167) a_dice_loss 0.9238 (0.9575) p-ce_loss 0.7136 (0.6219) lr 2.0000e-03
2025-08-09 17:50:28.175 | INFO     | src.train:forward:129 - epoch [1/80] batch [35/53] loss 3.9800 (4.8599) i-auroc 60.2564 (70.2862) p-auroc 75.1463 (50.7076) focal_loss 0.0198 (0.4607) a_dice_loss 0.9910 (0.9589) p-ce_loss 0.0405 (0.5676) lr 2.0000e-03
2025-08-09 17:50:28.819 | INFO     | src.train:forward:129 - epoch [1/80] batch [40/53] loss 4.5499 (4.7973) i-auroc 83.3333 (68.6095) p-auroc 56.0080 (53.1300) focal_loss 0.5991 (0.4259) a_dice_loss 0.9891 (0.9630) p-ce_loss 0.6140 (0.5209) lr 2.0000e-03
2025-08-09 17:50:30.339 | INFO     | src.train:forward:129 - epoch [1/80] batch [45/53] loss 4.0598 (4.7733) i-auroc 73.9583 (69.2237) p-auroc 64.5094 (53.3198) focal_loss 0.0172 (0.4186) a_dice_loss 0.9940 (0.9660) p-ce_loss 0.0426 (0.5054) lr 2.0000e-03
2025-08-09 17:50:30.692 | INFO     | src.train:forward:129 - epoch [1/80] batch [50/53] loss 3.9140 (4.6788) i-auroc 77.9221 (70.6376) p-auroc 67.4712 (53.3317) focal_loss 0.0383 (0.3969) a_dice_loss 0.9645 (0.9654) p-ce_loss 0.1893 (0.4849) lr 2.0000e-03
